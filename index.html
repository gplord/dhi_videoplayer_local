<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Comparative Japanese Film Archive - Proof of Concept</title>

<link href="style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="css/jquery.lightbox-0.5.css" media="screen" />
<link rel="stylesheet" href="video-js.css" type="text/css" media="screen" title="Video JS">

<script src="http://code.jquery.com/jquery-1.5.2.min.js"></script>
<script type="text/javascript" src="js/jquery.lightbox-0.5.min.js"></script>

<script src="video.js" type="text/javascript" charset="utf-8"></script>
<script src="popcorn.js" type="text/javascript" charset="utf-8"></script>

<script src="plugins/footnote/popcorn.footnote.js"></script>
<script src="plugins/transcript/popcorn.transcript.js"></script>

<script src="parsers/parserXML/popcorn.parseXML.js"></script>

<script type="text/javascript">
	// Must come after the video.js library

	// Add VideoJS to all video tags on the page when the DOM is ready
	VideoJS.setupAllWhenReady();

	var highlightedLine = 0;

	function goToLine(num) {
		$("#tLine"+highlightedLine).toggleClass('highlighted');
		highlightedLine = num;
		$("#tLine"+highlightedLine).toggleClass('highlighted');
		$("#rolling_transcript").scrollTop(0);
		var pos = $("#tLine"+num).position().top;
		$("#rolling_transcript").scrollTop(pos);
	}

	$(function() {
		$('a.lightbox').lightBox(); // Select all links with lightbox class
	});

</script>

<script>

	function loadXMLDoc(dname) {
		if (window.XMLHttpRequest) {
			xhttp=new XMLHttpRequest();
		} else {
			xhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}
		xhttp.open("GET",dname,false);
		xhttp.send("");
		return xhttp.responseXML;
	}

	function displayResult() {
		xml=loadXMLDoc("datatest.xml");
		xsl=loadXMLDoc("test.xsl");

		// code for IE
		if (window.ActiveXObject) {
		ex=xml.transformNode(xsl);
		document.getElementById("rolling_transcript").innerHTML=ex;
	}

	// code for Mozilla, Firefox, Opera, etc.
	else if (document.implementation && document.implementation.createDocument)	{
		xsltProcessor=new XSLTProcessor();
		xsltProcessor.importStylesheet(xsl);
		resultDocument = xsltProcessor.transformToFragment(xml,document);
		document.getElementById("rolling_transcript").appendChild(resultDocument);
	}

	// After parsing XML, provide click function for each transcript line group set
	$(".transcriptLineGroup").click(function() {
		var timeInMs = this.getAttribute("data-time-in-ms");		
		var video = document.getElementsByTagName("video")[0];
		video.currentTime = timeInMs; 
		video.play();
	});

}

</script>
</head>

<body onload="displayResult()">	

<section id="wrapper">

	<header>

		<div id="title">
			<ul id="nav">
				<li><a href="about.html">About</a></li>
				<li><a href="index.html">Demo</a></li>
				<li><a href="team.html">Project Team</a></li>
				<li><a href="contact.html">Contact</a></li>
			</ul>
		</div>

	</header>

	<div id="browser_message">
		<strong>This demo requires HTML5 and is designed to work with the most recent versions of Chrome and Safari.</strong>  If you do not see a playable video object below, please use one of these browsers or upgrade your browser to the latest version.
	</div>

	<div id="titlebar">
		<a id="metadata">Download Metadata <small>[XSLX, 134kb]</a>
		<h2>The Cabinet of Dr. Caligari</h2>
	</div>

	<!-- Start Left Column -->
	<div id="leftcontent">
		<article id="videobox">

			<!-- Begin VideoJS -->
			<div class="video-js-box">

				<video id="video" class="video-js" width="320" height="240" controls="controls" preload="auto" poster="images/poster.jpg" data-timeline-sources="datatest.xml">
					<source src="caligari_1_vas.mov">
				</video>  

			</div>
			<!-- End VideoJS -->

		</article>

		<aside id="sources">

			<h3>Footnotes &amp; Annotations</h3>
			<img src="images/video.png" alt="video" class="icons">
			<div class="content" id="footnote"><div class="overlay"></div><div class="inactive"></div></div>
		</aside>

	</div>

<!-- Start Right Column -->

	<div id="rightcontent">


		<aside id="sources">
			<h4>Transcription</h4>

			<div class="content" id="videoattribution">
				<img src="images/notes.png" alt="notes" class="icons">
				<div class="overlay"></div>
				<div class="inactive">
				</div>
			</div>
		</aside>

		<div id="rolling_transcript"></div>

	</div>

	<aside id="related">
		<h4>Related Media</h4>
		<ul>
			<li><a class="lightbox" href="images/TokugawaMusei.jpg" title="Portrait of Tokugawa Musei, Benshi"><img src="images/TokugawaMusei_sm.jpg" alt="Tokugawa Musei Thumbnail" /></a>Tokugawa Musei</li>
			<li><a href="files/TOKUGAWAMusei.docx"><img src="images/icon_word.png" alt="Tokugawa Musei Biography"></a>Musei Biography</li>
			<li><a class="lightbox" href="images/benshi_large.png" title="Poster of a Benshi Performer"><img src="images/benshi_small.png" alt="Benshi Thumbnail" /></a>Benshi Poster</li>
			<li><a class="lightbox" href="images/benshi_chart.png" title="Chart of Benshi Performances"><img src="images/benshi_chart_small.png" alt="Benshi Chart Thumbnail" /></a>Benshi Chart</li>
			<li><a class="lightbox" href="images/caligari_poster.png" title="Film poster for the Cabinet of Dr. Caligari (Robert Wiene, dir. 1919)"><img src="images/caligari_poster_small.png" alt="Caligari Poster Thumbnail" /></a>Film Poster</li>
			<li><a href="#"><img src="images/mp3_small.png" alt="Audio MP3" /></a>Japanese Audio</li>
			<li><a href="files/Omori_Collection_Metadata.xlsx"><img src="images/metadata_sm.png" alt="Excel Metadata" /></a>Download Metadata</li>
			<li><a href="files/Waseda_Komada_digitized scripts.xls"><img src="images/metadata_sm.png" alt="Excel Metadata" /></a>Digitized Scripts</li>
		</ul>
	</aside>
	
	<footer>Proof of concept for the <a href="http://www.dhinitiative.org">Digital Humanities Inititiave (DHi)<a/> <img style="float: right;" src="images/dhi_logo.png" /><div style="clear: both"></div></footer>
		
</section>

</body>
</html>


